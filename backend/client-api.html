
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Client API Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="debugger-api.html" />
    
    
    <link rel="prev" href="protocol.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    Getting started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting-started/where-is-the-code.html">
            
                <a href="../getting-started/where-is-the-code.html">
            
                    
                    Where is the code?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting-started/architecture-overview.html">
            
                <a href="../getting-started/architecture-overview.html">
            
                    
                    Architecture overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../getting-started/build.html">
            
                <a href="../getting-started/build.html">
            
                    
                    Set up to build DevTools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../getting-started/development-profiles.html">
            
                <a href="../getting-started/development-profiles.html">
            
                    
                    Development profiles
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../contributing.html">
            
                <a href="../contributing.html">
            
                    
                    Contributing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../contributing/coding-standards.html">
            
                <a href="../contributing/coding-standards.html">
            
                    
                    Coding standards
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="../contributing/javascript.html">
            
                <a href="../contributing/javascript.html">
            
                    
                    JavaScript
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1.1" data-path="../contributing/eslint.html">
            
                <a href="../contributing/eslint.html">
            
                    
                    ESLint
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="../contributing/css.html">
            
                <a href="../contributing/css.html">
            
                    
                    CSS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../contributing/making-prs.html">
            
                <a href="../contributing/making-prs.html">
            
                    
                    Creating and sending patches
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../contributing/code-reviews.html">
            
                <a href="../contributing/code-reviews.html">
            
                    
                    Code reviews
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../contributing/filing-good-bugs.html">
            
                <a href="../contributing/filing-good-bugs.html">
            
                    
                    Filing good bugs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../bugs-issues.html">
            
                <a href="../bugs-issues.html">
            
                    
                    Bugs and issue trackers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../files/">
            
                <a href="../files/">
            
                    
                    Files and directories
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../files/adding-files.html">
            
                <a href="../files/adding-files.html">
            
                    
                    Adding New Files
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../tools/tools.html">
            
                <a href="../tools/tools.html">
            
                    
                    Tool Architectures
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../tools/inspector.html">
            
                <a href="../tools/inspector.html">
            
                    
                    Inspector
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1.1" data-path="../tools/inspector-panel.html">
            
                <a href="../tools/inspector-panel.html">
            
                    
                    Panel Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.1.2" data-path="../tools/highlighters.html">
            
                <a href="../tools/highlighters.html">
            
                    
                    Highlighters
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../tools/memory-panel.html">
            
                <a href="../tools/memory-panel.html">
            
                    
                    Memory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../tools/debugger-panel.html">
            
                <a href="../tools/debugger-panel.html">
            
                    
                    Debugger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../tools/responsive-design-mode.html">
            
                <a href="../tools/responsive-design-mode.html">
            
                    
                    Responsive Design Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../tools/http-inspector.html">
            
                <a href="../tools/http-inspector.html">
            
                    
                    HTTP Inspector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../tools/console-panel.html">
            
                <a href="../tools/console-panel.html">
            
                    
                    Console
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../frontend/frontend.html">
            
                <a href="../frontend/frontend.html">
            
                    
                    Frontend
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../frontend/svgs.html">
            
                <a href="../frontend/svgs.html">
            
                    
                    Panel SVGs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../frontend/react.html">
            
                <a href="../frontend/react.html">
            
                    
                    React
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.2.1" data-path="../frontend/react-guidelines.html">
            
                <a href="../frontend/react-guidelines.html">
            
                    
                    Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2.2" data-path="../frontend/react-tips.html">
            
                <a href="../frontend/react-tips.html">
            
                    
                    Tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../frontend/redux.html">
            
                <a href="../frontend/redux.html">
            
                    
                    Redux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.3.1" data-path="../frontend/redux-guidelines.html">
            
                <a href="../frontend/redux-guidelines.html">
            
                    
                    Guidelines
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3.2" data-path="../frontend/redux-tips.html">
            
                <a href="../frontend/redux-tips.html">
            
                    
                    Tips
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../frontend/telemetry.html">
            
                <a href="../frontend/telemetry.html">
            
                    
                    Telemetry
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="backend.html">
            
                <a href="backend.html">
            
                    
                    Backend
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="protocol.html">
            
                <a href="protocol.html">
            
                    
                    Remote Debugging Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.8.2" data-path="client-api.html">
            
                <a href="client-api.html">
            
                    
                    Client API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="debugger-api.html">
            
                <a href="debugger-api.html">
            
                    
                    Debugger API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="backward-compatibility.html">
            
                <a href="backward-compatibility.html">
            
                    
                    Backward Compatibility
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" >
            
                <span>
            
                    
                    Actors
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.5.1" data-path="actor-hierarchy.html">
            
                <a href="actor-hierarchy.html">
            
                    
                    Actors Organization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.2" data-path="actor-e10s-handling.html">
            
                <a href="actor-e10s-handling.html">
            
                    
                    Handling Multi-Processes in Actors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.3" data-path="protocol.js.html">
            
                <a href="protocol.js.html">
            
                    
                    Writing Actors With protocol.js
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.4" data-path="actor-registration.html">
            
                <a href="actor-registration.html">
            
                    
                    Registering A New Actor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5.5" data-path="actor-best-practices.html">
            
                <a href="actor-best-practices.html">
            
                    
                    Actor Best Practices
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../tests/">
            
                <a href="../tests/">
            
                    
                    Automated tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" >
            
                <span>
            
                    
                    Running tests
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1.1" data-path="../tests/xpcshell.html">
            
                <a href="../tests/xpcshell.html">
            
                    
                    xpcshell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.2" data-path="../tests/mochitest-chrome.html">
            
                <a href="../tests/mochitest-chrome.html">
            
                    
                    Chrome mochitests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.1.3" data-path="../tests/mochitest-devtools.html">
            
                <a href="../tests/mochitest-devtools.html">
            
                    
                    DevTools mochitests
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../tests/writing-tests.html">
            
                <a href="../tests/writing-tests.html">
            
                    
                    Writing tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../tests/debugging-intermittents.html">
            
                <a href="../tests/debugging-intermittents.html">
            
                    
                    Debugging intermittent failures
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Client API</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="client-api">Client API</h1>
<p>DevTools has a client module that allows applications to be written that debug or inspect web pages using the <a href="protocol.html">Remote Debugging Protocol</a>.</p>
<h2 id="starting-communication">Starting communication</h2>
<p>In order to communicate, a client and a server instance must be created and a protocol connection must be established. The connection can be either over a TCP socket or an nsIPipe. The <code>start</code> function displayed below establishes an nsIPipe-backed connection:</p>
<pre><code class="lang-javascript">Components.utils.import(<span class="hljs-string">&quot;resource://gre/modules/devtools/dbg-server.jsm&quot;</span>);
Components.utils.import(<span class="hljs-string">&quot;resource://gre/modules/devtools/dbg-client.jsm&quot;</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Start the server.</span>
  <span class="hljs-keyword">if</span> (!DebuggerServer.initialized) {
    DebuggerServer.init();
    DebuggerServer.addBrowserActors();
  }

  <span class="hljs-comment">// Listen to an nsIPipe</span>
  <span class="hljs-keyword">let</span> transport = DebuggerServer.connectPipe();

  <span class="hljs-comment">// Start the client.</span>
  client = <span class="hljs-keyword">new</span> DebuggerClient(transport);

  <span class="hljs-comment">// Attach listeners for client events.</span>
  client.addListener(<span class="hljs-string">&quot;tabNavigated&quot;</span>, onTab);
  client.addListener(<span class="hljs-string">&quot;newScript&quot;</span>, onScript);
  client.connect((type, traits) =&gt; {
    <span class="hljs-comment">// Now the client is conected to the server.</span>
    debugTab();
  });
}
</code></pre>
<p>If a TCP socket is required, the function should be split in two parts, a server-side and a client-side, like this:</p>
<pre><code class="lang-javascript">Components.utils.import(<span class="hljs-string">&quot;resource://gre/modules/devtools/dbg-server.jsm&quot;</span>);
Components.utils.import(<span class="hljs-string">&quot;resource://gre/modules/devtools/dbg-client.jsm&quot;</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startServer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Start the server.</span>
  <span class="hljs-keyword">if</span> (!DebuggerServer.initialized) {
    DebuggerServer.init();
    DebuggerServer.addBrowserActors();
  }

  <span class="hljs-comment">// For an nsIServerSocket we do this:</span>
  DebuggerServer.openListener(<span class="hljs-number">2929</span>); <span class="hljs-comment">// A connection on port 2929.</span>
}

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startClient</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> transport = <span class="hljs-keyword">await</span> DebuggerClient.socketConnect({ host: <span class="hljs-string">&quot;localhost&quot;</span>, port: <span class="hljs-number">2929</span> });

  <span class="hljs-comment">// Start the client.</span>
  client = <span class="hljs-keyword">new</span> DebuggerClient(transport);

  <span class="hljs-comment">// Attach listeners for client events.</span>
  client.addListener(<span class="hljs-string">&quot;tabNavigated&quot;</span>, onTab);
  client.addListener(<span class="hljs-string">&quot;newScript&quot;</span>, onScript);

  client.connect((type, traits) =&gt; {
    <span class="hljs-comment">// Now the client is conected to the server.</span>
    debugTab();
  });
}
</code></pre>
<h2 id="shutting-down">Shutting down</h2>
<p>When the application is finished, it has to notify the client to shut down the protocol connection. This makes sure that memory leaks are avoided and the server is terminated in an orderly fashion. Shutting down is as simple as it gets:</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shutdown</span>(<span class="hljs-params"></span>) </span>{
  client.close();
}
</code></pre>
<h2 id="attaching-to-a-browser-tab">Attaching to a browser tab</h2>
<p>Attaching to a browser tab requires enumerating the available tabs and attaching to one:</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attachToTab</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Get the list of tabs to find the one to attach to.</span>
  client.listTabs((response) =&gt; {
    <span class="hljs-comment">// Find the active tab.</span>
    <span class="hljs-keyword">let</span> tab = response.tabs[response.selected];

    <span class="hljs-comment">// Attach to the tab.</span>
    client.attachTab(tab.actor, (response, tabClient) =&gt; {
      <span class="hljs-keyword">if</span> (!tabClient) {
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-comment">// Now the tabClient is ready and can be used.</span>
    });
  });
}
</code></pre>
<p>The debugger client will send event notifications for a number of events the application may be interested in. These events include state changes in the debugger, like pausing and resuming, stack frames or source scripts being ready for retrieval, etc.</p>
<h2 id="handling-location-changes">Handling location changes</h2>
<p>When the user navigates away from a page, a <code>tabNavigated</code> event will be fired. The proper way to handle this event is to detach from the previous thread and tab and attach to the new ones:</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTab</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Detach from the previous thread.</span>
  client.activeThread.detach(() =&gt; {
    <span class="hljs-comment">// Detach from the previous tab.</span>
    client.activeTab.detach(() =&gt; {
      <span class="hljs-comment">// Start debugging the new tab.</span>
      start();
    });
  });
}
</code></pre>
<h2 id="debugging-javascript-running-in-a-browser-tab">Debugging JavaScript running in a browser tab</h2>
<p>Once the application is attached to a tab, it can attach to its thread in order to interact with the JavaScript debugger:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">// Assuming the application is already attached to the tab, and response is the first</span>
<span class="hljs-comment">// argument of the attachTab callback.</span>

client.attachThread(response.threadActor, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response, threadClient</span>) </span>{
  <span class="hljs-keyword">if</span> (!threadClient) {
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Attach listeners for thread events.</span>
  threadClient.addListener(<span class="hljs-string">&quot;paused&quot;</span>, onPause);
  threadClient.addListener(<span class="hljs-string">&quot;resumed&quot;</span>, fooListener);
  threadClient.addListener(<span class="hljs-string">&quot;detached&quot;</span>, fooListener);
  threadClient.addListener(<span class="hljs-string">&quot;framesadded&quot;</span>, onFrames);
  threadClient.addListener(<span class="hljs-string">&quot;framescleared&quot;</span>, fooListener);
  threadClient.addListener(<span class="hljs-string">&quot;scriptsadded&quot;</span>, onScripts);
  threadClient.addListener(<span class="hljs-string">&quot;scriptscleared&quot;</span>, fooListener);

  <span class="hljs-comment">// Resume the thread.</span>
  threadClient.resume();

  <span class="hljs-comment">// Debugger is now ready and debuggee is running.</span>
});
</code></pre>
<h2 id="debugger-application-example">Debugger application example</h2>
<p>Here is the source code for a complete debugger application:</p>
<pre><code class="lang-javascript"><span class="hljs-comment">/*
 * Debugger API demo.
 * Try it in Scratchpad with Environment -&gt; Browser, using
 * http://htmlpad.org/debugger/ as the current page.
 */</span>
Components.utils.import(<span class="hljs-string">&quot;resource://gre/modules/devtools/dbg-server.jsm&quot;</span>);
Components.utils.import(<span class="hljs-string">&quot;resource://gre/modules/devtools/dbg-client.jsm&quot;</span>);

<span class="hljs-keyword">let</span> client;
<span class="hljs-keyword">let</span> threadClient;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startDebugger</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Start the server.</span>
  <span class="hljs-keyword">if</span> (!DebuggerServer.initialized) {
    DebuggerServer.init();
    DebuggerServer.addBrowserActors();
  }
  <span class="hljs-comment">// Listen to an nsIPipe</span>
  <span class="hljs-keyword">let</span> transport = DebuggerServer.connectPipe();
  <span class="hljs-comment">// For an nsIServerSocket we do this:</span>
  <span class="hljs-comment">// DebuggerServer.openListener(port);</span>
  <span class="hljs-comment">// ...and this at the client:</span>
  <span class="hljs-comment">// let transport = debuggerSocketConnect(host, port);</span>

  <span class="hljs-comment">// Start the client.</span>
  client = <span class="hljs-keyword">new</span> DebuggerClient(transport);
  <span class="hljs-comment">// Attach listeners for client events.</span>
  client.addListener(<span class="hljs-string">&quot;tabNavigated&quot;</span>, onTab);
  client.addListener(<span class="hljs-string">&quot;newScript&quot;</span>, fooListener);
  client.connect((type, traits) =&gt; {
    <span class="hljs-comment">// Now the client is conected to the server.</span>
    debugTab();
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shutdownDebugger</span>(<span class="hljs-params"></span>) </span>{
  client.close();
}

<span class="hljs-comment">/**
 * Start debugging the current tab.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debugTab</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Get the list of tabs to find the one to attach to.</span>
  client.listTabs(response =&gt; {
    <span class="hljs-comment">// Find the active tab.</span>
    <span class="hljs-keyword">let</span> tab = response.tabs[response.selected];
    <span class="hljs-comment">// Attach to the tab.</span>
    client.attachTab(tab.actor, (response, tabClient) =&gt; {
      <span class="hljs-keyword">if</span> (!tabClient) {
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-comment">// Attach to the thread (context).</span>
      client.attachThread(response.threadActor, (response, thread) =&gt; {
        <span class="hljs-keyword">if</span> (!thread) {
          <span class="hljs-keyword">return</span>;
        }

        threadClient = thread;
        <span class="hljs-comment">// Attach listeners for thread events.</span>
        threadClient.addListener(<span class="hljs-string">&quot;paused&quot;</span>, onPause);
        threadClient.addListener(<span class="hljs-string">&quot;resumed&quot;</span>, fooListener);
        threadClient.addListener(<span class="hljs-string">&quot;detached&quot;</span>, fooListener);
        threadClient.addListener(<span class="hljs-string">&quot;framesadded&quot;</span>, onFrames);
        threadClient.addListener(<span class="hljs-string">&quot;framescleared&quot;</span>, fooListener);
        threadClient.addListener(<span class="hljs-string">&quot;scriptsadded&quot;</span>, onScripts);
        threadClient.addListener(<span class="hljs-string">&quot;scriptscleared&quot;</span>, fooListener);

        <span class="hljs-comment">// Resume the thread.</span>
        threadClient.resume();
        <span class="hljs-comment">// Debugger is now ready and debuggee is running.</span>
      });
    });
  });
}

<span class="hljs-comment">/**
 * Handler for location changes.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTab</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Detach from the previous thread.</span>
  client.activeThread.detach(() =&gt; {
    <span class="hljs-comment">// Detach from the previous tab.</span>
    client.activeTab.detach(() =&gt; {
      <span class="hljs-comment">// Start debugging the new tab.</span>
      debugTab();
    });
  });
}

<span class="hljs-comment">/**
 * Handler for entering pause state.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onPause</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Get the top 20 frames in the server&apos;s frame stack cache.</span>
  client.activeThread.fillFrames(<span class="hljs-number">20</span>);
  <span class="hljs-comment">// Get the scripts loaded in the server&apos;s source script cache.</span>
  client.activeThread.fillScripts();
}

<span class="hljs-comment">/**
 * Handler for framesadded events.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onFrames</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Get the list of frames in the server.</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> frame <span class="hljs-keyword">of</span> client.activeThread.cachedFrames) {
    <span class="hljs-comment">// frame is a Debugger.Frame grip.</span>
    dump(<span class="hljs-string">&quot;frame: &quot;</span> + frame.toSource() + <span class="hljs-string">&quot;\n&quot;</span>);
    inspectFrame(frame);
  }
}

<span class="hljs-comment">/**
 * Handler for scriptsadded events.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onScripts</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Get the list of scripts in the server.</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> script <span class="hljs-keyword">of</span> client.activeThread.cachedScripts) {
    <span class="hljs-comment">// script is a Debugger.Script grip.</span>
    dump(<span class="hljs-string">&quot;script: &quot;</span> + script.toSource() + <span class="hljs-string">&quot;\n&quot;</span>);
  }

  <span class="hljs-comment">// Resume execution, since this is the last thing going on in the paused</span>
  <span class="hljs-comment">// state and there is no UI in this program. Wait a bit so that object</span>
  <span class="hljs-comment">// inspection has a chance to finish.</span>
  setTimeout(() =&gt; {
    threadClient.resume();
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">/**
 * Helper function to inspect the provided frame.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inspectFrame</span>(<span class="hljs-params">frame</span>) </span>{
  <span class="hljs-comment">// Get the &quot;this&quot; object.</span>
  <span class="hljs-keyword">if</span> (frame[<span class="hljs-string">&quot;this&quot;</span>]) {
    getObjectProperties(frame[<span class="hljs-string">&quot;this&quot;</span>]);
  }

  <span class="hljs-comment">// Add &quot;arguments&quot;.</span>
  <span class="hljs-keyword">if</span> (frame.arguments &amp;&amp; frame.arguments.length &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// frame.arguments is a regular Array.</span>
    dump(<span class="hljs-string">&quot;frame.arguments: &quot;</span> + frame.arguments.toSource() + <span class="hljs-string">&quot;\n&quot;</span>);

    <span class="hljs-comment">// Add variables for every argument.</span>
    <span class="hljs-keyword">let</span> objClient = client.activeThread.pauseGrip(frame.callee);
    objClient.getSignature(response =&gt; {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; response.parameters.length; i++) {
        <span class="hljs-keyword">let</span> name = response.parameters[i];
        <span class="hljs-keyword">let</span> value = frame.arguments[i];

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value == <span class="hljs-string">&quot;object&quot;</span> &amp;&amp; value.type == <span class="hljs-string">&quot;object&quot;</span>) {
          getObjectProperties(value);
        }
      }
    });
  }
}

<span class="hljs-comment">/**
 * Helper function that retrieves the specified object&apos;s properties.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getObjectProperties</span>(<span class="hljs-params">object</span>) </span>{
  <span class="hljs-keyword">let</span> thisClient = client.activeThread.pauseGrip(object);
  thisClient.getPrototypeAndProperties(response =&gt; {
    <span class="hljs-comment">// Get prototype as a protocol-specified grip.</span>
    <span class="hljs-keyword">if</span> (response.prototype.type != <span class="hljs-string">&quot;null&quot;</span>) {
      dump(<span class="hljs-string">&quot;__proto__: &quot;</span> + response.prototype.toSource() + <span class="hljs-string">&quot;\n&quot;</span>);
    }

    <span class="hljs-comment">// Get the rest of the object&apos;s own properties as protocol-specified grips.</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> prop <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.keys(response.ownProperties)) {
      dump(prop + <span class="hljs-string">&quot;: &quot;</span> + response.ownProperties[prop].toSource() + <span class="hljs-string">&quot;\n&quot;</span>);
    }
  });
}

<span class="hljs-comment">/**
 * Generic event listener.
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fooListener</span>(<span class="hljs-params">event</span>) </span>{
  dump(event + <span class="hljs-string">&quot;\n&quot;</span>);
}

<span class="hljs-comment">// Run the program.</span>
startDebugger();

<span class="hljs-comment">// Execute the following line to stop the program.</span>
<span class="hljs-comment">//shutdownDebugger();</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="protocol.html" class="navigation navigation-prev " aria-label="Previous page: Remote Debugging Protocol">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="debugger-api.html" class="navigation navigation-next " aria-label="Next page: Debugger API">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Client API","level":"1.8.2","depth":2,"next":{"title":"Debugger API","level":"1.8.3","depth":2,"path":"backend/debugger-api.md","ref":"backend/debugger-api.md","articles":[]},"previous":{"title":"Remote Debugging Protocol","level":"1.8.1","depth":2,"path":"backend/protocol.md","ref":"backend/protocol.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"backend/client-api.md","mtime":"2017-08-28T17:34:12.620Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-08-28T17:34:41.132Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

